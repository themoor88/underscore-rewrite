// First the each then map then reduce function.